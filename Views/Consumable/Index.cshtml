@model IEnumerable<ONT_3rdyear_Project.Models.Consumable>
@{
    ViewData["Title"] = "Wards";
    ViewData["ActivePage"] = "Wards"; // Set the active page for the navigation bar

}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4 flex-nowrap overflow-auto">
                <h1 class="h3 mb-0 text-nowrap me-3">All Consumables</h1>
                <div class="d-flex flex-nowrap gap-2">
                    <button class="btn btn-primary" name="wardId" value="1" id="openModalBtn">Add Consumable</button>
                    <div id="modalContainer"></div>

                    <a asp-controller="Consumable" asp-action="Dashboard" class="btn btn-secondary text-nowrap">Back</a>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="position-relative">
</div>
<table class="table table-striped">
    <thead>
        <tr>
            <th>Name</th>
            <th>Category</th>
            <th>Active</th>
            <th>Action</th>

        </tr>
    </thead>
    <tbody>
        @foreach (var ward in Model)
        {
            <tr>
                <td>@ward.Name</td>
                <td>@ward.Category</td>
                <td>
                    @if (ward.IsDeleted)
                    {
                        <span class="badge bg-secondary">Inactive</span>
                    }
                    else
                    {
                        <span class="badge bg-success">Active</span>                      
                    }
                </td>

                <td>
                    <button type="button" class="btn btn-warning openEditModalBtn" data-id="@ward.ConsumableId">Edit</button>


                    <a asp-action="Delete" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this consumable');" asp-route-id="@ward.ConsumableId">Delete</a>

                </td>
            </tr>
        }
    </tbody>
</table>
<div id="modalContainer2"></div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            document.querySelectorAll(".openEditModalBtn").forEach(button => {
                button.addEventListener("click", function () {
                    const consumableId = this.getAttribute("data-id");

                    fetch(`/Consumable/EditConsumable/${consumableId}?partial=true`)
                        .then(res => res.text())
                        .then(html => {
                            document.getElementById("modalContainer2").innerHTML = html;
                            const modalEl = document.getElementById("editConsumableModal");
                            const modal = new bootstrap.Modal(modalEl);
                            modal.show();
                        });
                });
            });

            document.getElementById("openModalBtn").addEventListener("click", function () {
                fetch('@Url.Action("NewConsumable", "Consumable", new { partial = true })')
                    .then(res => res.text())
                    .then(html => {
                        document.getElementById("modalContainer").innerHTML = html;
                        const modalEl = document.getElementById("addConsumableModal");
                        const modal = new bootstrap.Modal(modalEl);
                        modal.show();
                    });
            });
        });


    </script>

}